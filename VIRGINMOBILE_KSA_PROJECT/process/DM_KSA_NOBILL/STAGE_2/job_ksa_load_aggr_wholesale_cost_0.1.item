<?xml version="1.0" encoding="UTF-8" standalone="no"?><talendfile:ProcessType xmlns:talendfile="platform:/resource/org.talend.model/model/TalendFile.xsd" xmlns:xmi="http://www.omg.org/XMI" defaultContext="KSA_PROD" framework="" jobType="Standard" xmi:version="2.0">
  <context confirmationNeeded="false" name="KSA_NONPROD">
    <contextParameter comment="" internalId="_yzZiYrksEeqLfP5Yr4khFQ" name="vLoadDate" prompt="vLoadDate?" promptNeeded="false" repositoryContextId="built-in" type="id_String" value=""/>
    <contextParameter comment="" internalId="_yzZiYbksEeqLfP5Yr4khFQ" name="vUpRechDiscPercent" prompt="vUpRechDiscPercent?" promptNeeded="false" repositoryContextId="built-in" type="id_Double" value=""/>
    <contextParameter comment="" internalId="_4oD0ML8PEe2E8pa9vcqpLw" name="connection_verticadb_additionalparam" prompt="connection_verticadb_additionalparam?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="backupservernode=10.4.93.11,10.4.93.12"/>
    <contextParameter comment="" internalId="_4oD0Mb8PEe2E8pa9vcqpLw" name="connection_verticadb_schema_prod" prompt="connection_verticadb_schema_prod?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="ksa_dev"/>
    <contextParameter comment="" internalId="_4oD0Mr8PEe2E8pa9vcqpLw" name="connection_verticadb_host" prompt="connection_verticadb_host?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="10.4.93.10"/>
    <contextParameter comment="" internalId="_4oD0M78PEe2E8pa9vcqpLw" name="connection_verticadb_port" prompt="connection_verticadb_port?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="5433"/>
    <contextParameter comment="" internalId="_4oD0NL8PEe2E8pa9vcqpLw" name="connection_verticadb_username" prompt="connection_verticadb_username?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="talend"/>
    <contextParameter comment="" internalId="_4oD0Nb8PEe2E8pa9vcqpLw" name="connection_verticadb_schema_stg" prompt="connection_verticadb_schema_stg?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="ksa_dev"/>
    <contextParameter comment="" internalId="_4oD0Nr8PEe2E8pa9vcqpLw" name="connection_verticadb_schema_audit" prompt="connection_verticadb_schema_audit?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="ksa_dev"/>
    <contextParameter comment="" internalId="_4oD0N78PEe2E8pa9vcqpLw" name="connection_verticadb_password" prompt="connection_verticadb_password?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_Password" value="enc:system.encryption.key.v1:EI8CdOOWT6cR2bzmuFh24qGEt9zlRUSJ/M8x85jWJARZwABcSbZbaBc/HlI="/>
    <contextParameter comment="" internalId="_4oD0OL8PEe2E8pa9vcqpLw" name="connection_verticadb_database" prompt="connection_verticadb_database?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="ksa_db_prod"/>
  </context>
  <context confirmationNeeded="false" name="KSA_PROD">
    <contextParameter comment="" internalId="_yzZiYrksEeqLfP5Yr4khFQ" name="vLoadDate" prompt="vLoadDate?" promptNeeded="false" repositoryContextId="built-in" type="id_String" value=""/>
    <contextParameter comment="" internalId="_yzZiYbksEeqLfP5Yr4khFQ" name="vUpRechDiscPercent" prompt="vUpRechDiscPercent?" promptNeeded="false" repositoryContextId="built-in" type="id_Double" value=""/>
    <contextParameter comment="" internalId="_4oD0Ob8PEe2E8pa9vcqpLw" name="connection_verticadb_additionalparam" prompt="connection_verticadb_additionalparam?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="backupservernode=10.4.93.11,10.4.93.12"/>
    <contextParameter comment="" internalId="_4oD0Or8PEe2E8pa9vcqpLw" name="connection_verticadb_schema_prod" prompt="connection_verticadb_schema_prod?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="ksa_prod"/>
    <contextParameter comment="" internalId="_4oD0O78PEe2E8pa9vcqpLw" name="connection_verticadb_host" prompt="connection_verticadb_host?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="10.4.93.10"/>
    <contextParameter comment="" internalId="_4oD0PL8PEe2E8pa9vcqpLw" name="connection_verticadb_port" prompt="connection_verticadb_port?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="5433"/>
    <contextParameter comment="" internalId="_4oD0Pb8PEe2E8pa9vcqpLw" name="connection_verticadb_username" prompt="connection_verticadb_username?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="talend"/>
    <contextParameter comment="" internalId="_4oD0Pr8PEe2E8pa9vcqpLw" name="connection_verticadb_schema_stg" prompt="connection_verticadb_schema_stg?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="ksa_stg"/>
    <contextParameter comment="" internalId="_4oD0P78PEe2E8pa9vcqpLw" name="connection_verticadb_schema_audit" prompt="connection_verticadb_schema_audit?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="ksa_audit"/>
    <contextParameter comment="" internalId="_4oD0QL8PEe2E8pa9vcqpLw" name="connection_verticadb_password" prompt="connection_verticadb_password?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_Password" value="enc:system.encryption.key.v1:WoteikQCz5qKKuy71nt+HvN7lx7c6nGBupoDtNV4dnpox7NmWf9js3SYQJc="/>
    <contextParameter comment="" internalId="_4oD0Qb8PEe2E8pa9vcqpLw" name="connection_verticadb_database" prompt="connection_verticadb_database?" promptNeeded="false" repositoryContextId="_umyxcHglEeq7va8PH6KsVQ" type="id_String" value="ksa_db_prod"/>
  </context>
  <parameters>
    <elementParameter field="CLOSED_LIST" name="LOG4J_RUN_LEVEL" show="false" value="Info"/>
    <elementParameter field="TEXT" name="JOB_RUN_VM_ARGUMENTS" show="false" value="{&quot;JOB_RUN_VM_ARGUMENTS&quot;:[&quot;-Xms2048M&quot;,&quot;-Xmx2048M&quot;]}"/>
    <elementParameter field="CHECK" name="JOB_RUN_VM_ARGUMENTS_OPTION" show="false" value="true"/>
    <elementParameter field="TEXT" name="SCREEN_OFFSET_X" show="false" value="64"/>
    <elementParameter field="TEXT" name="SCREEN_OFFSET_Y" show="false" value="288"/>
    <elementParameter field="TEXT" name="REPOSITORY_CONNECTION_ID" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_PROPERTY_TYPENAME" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_HADOOP_DISTRIBUTION" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_HADOOP_VERSION" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_ENABLE_KERBEROS" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_NAME_NODE_PRINCIPAL" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_USERNAME" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_GROUP" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_USE_KEYTAB" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_KT_PRINCIPAL" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_KEY_TAB" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_ENABLE_OO_KERBEROS" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_NAME_NODE_END_POINT" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_JOB_TRACKER_ENDPOINT" show="false" value=""/>
    <elementParameter field="TEXT" name="OOZIE_END_POINT" show="false" value=""/>
    <elementParameter field="CHECK" name="IMPLICITCONTEXT_USE_PROJECT_SETTINGS" show="false" value="true"/>
    <elementParameter field="CHECK" name="STATANDLOG_USE_PROJECT_SETTINGS" show="false" value="true"/>
    <elementParameter field="CHECK" name="MULTI_THREAD_EXECATION" value="true"/>
    <elementParameter field="TEXT" name="PARALLELIZE_UNIT_SIZE" value="25000"/>
    <elementParameter field="CHECK" name="IMPLICIT_TCONTEXTLOAD" value="false"/>
    <elementParameter field="RADIO" name="FROM_FILE_FLAG_IMPLICIT_CONTEXT" show="false" value="false"/>
    <elementParameter field="RADIO" name="FROM_DATABASE_FLAG_IMPLICIT_CONTEXT" show="false" value="false"/>
    <elementParameter field="FILE" name="IMPLICIT_TCONTEXTLOAD_FILE" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="FIELDSEPARATOR" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="OVERRIDE_ENCODING_FLAG" show="false" value="false"/>
    <elementParameter field="ENCODING_TYPE" name="OVERRIDE_ENCODING_IN_EXTRA" show="false" value="ISO-8859-15"/>
    <elementParameter field="TECHNICAL" name="OVERRIDE_ENCODING_IN_EXTRA:ENCODING_TYPE" show="false" value="ISO-8859-15"/>
    <elementParameter field="CLOSED_LIST" name="DB_TYPE_IMPLICIT_CONTEXT" show="false" value=""/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION_IMPLICIT_CONTEXT" show="false" value=""/>
    <elementParameter field="TEXT" name="URL_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TABLE" name="DRIVER_JAR_IMPLICIT_CONTEXT" show="false"/>
    <elementParameter field="TEXT" name="DRIVER_CLASS_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="HOST_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PORT_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="DBNAME_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="LOCAL_SERVICE_NAME_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="USER_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="PASSWORD" name="PASS_IMPLICIT_CONTEXT" show="false" value="enc:system.encryption.key.v1:FGqs4vIdMackYMWaoJQWwmUJhKh0kC0FLdioHjqf"/>
    <elementParameter field="FILE" name="DBFILE_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="DBTABLE_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="QUERY_CONDITION_IMPLICIT_CONTEXT" show="false" value="&quot;&quot;"/>
    <elementParameter field="CLOSED_LIST" name="LOAD_NEW_VARIABLE" show="false" value="Warning"/>
    <elementParameter field="CLOSED_LIST" name="NOT_LOAD_OLD_VARIABLE" show="false" value="Warning"/>
    <elementParameter field="CHECK" name="PRINT_OPERATIONS" show="false" value="false"/>
    <elementParameter field="CHECK" name="DISABLE_ERROR" show="false" value="false"/>
    <elementParameter field="CHECK" name="DISABLE_WARNINGS" show="false" value="false"/>
    <elementParameter field="CHECK" name="DISABLE_INFO" show="false" value="false"/>
    <elementParameter field="CHECK" name="ON_STATCATCHER_FLAG" value="false"/>
    <elementParameter field="CHECK" name="ON_LOGCATCHER_FLAG" value="false"/>
    <elementParameter field="CHECK" name="ON_METERCATCHER_FLAG" value="false"/>
    <elementParameter field="CHECK" name="ON_CONSOLE_FLAG" show="false" value="false"/>
    <elementParameter field="CHECK" name="ON_FILES_FLAG" show="false" value="false"/>
    <elementParameter field="DIRECTORY" name="FILE_PATH" show="false" value="&quot;D:/VirgnMobile_TalendStudio/workspace_731_20200323/.metadata&quot;"/>
    <elementParameter field="TEXT" name="FILENAME_STATS" show="false" value="&quot;stats_file.txt&quot;"/>
    <elementParameter field="TEXT" name="FILENAME_LOGS" show="false" value="&quot;logs_file.txt&quot;"/>
    <elementParameter field="TEXT" name="FILENAME_METTER" show="false" value="&quot;meter_file.txt&quot;"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="ISO-8859-15"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" show="false" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="ON_DATABASE_FLAG" show="false" value="false"/>
    <elementParameter field="CLOSED_LIST" name="DB_TYPE" show="false" value="tJDBCOutput"/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" show="false" value="ORACLE_12"/>
    <elementParameter field="TEXT" name="URL" show="false" value="&quot;&quot;"/>
    <elementParameter field="TABLE" name="DRIVER_JAR" show="false"/>
    <elementParameter field="TEXT" name="DRIVER_CLASS" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="HOST" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PORT" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="DATASOURCE" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="DBNAME" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="LOCAL_SERVICE_NAME" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="PROPERTIES" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" show="false" value="&quot;&quot;"/>
    <elementParameter field="TEXT" name="USER" show="false" value="&quot;&quot;"/>
    <elementParameter field="PASSWORD" name="PASS" show="false" value="enc:system.encryption.key.v1:MlWziOjo4+p0+pNOlYBufhpXjVfBDOZNLIeTmrmI"/>
    <elementParameter field="FILE" name="DBFILE" show="false" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="TABLE_STATS" show="false" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="TABLE_LOGS" show="false" value="&quot;&quot;"/>
    <elementParameter field="DBTABLE" name="TABLE_METER" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="CATCH_RUNTIME_ERRORS" show="false" value="true"/>
    <elementParameter field="CHECK" name="CATCH_USER_ERRORS" show="false" value="true"/>
    <elementParameter field="CHECK" name="CATCH_USER_WARNING" show="false" value="true"/>
    <elementParameter field="CHECK" name="CATCH_REALTIME_STATS" show="false" value="false"/>
    <elementParameter field="TEXT" name="HEADERFOOTER_HEADERID" show="false" value=""/>
    <elementParameter field="CHECK" name="HEADER_ENABLED" show="false" value="false"/>
    <elementParameter field="TEXT" name="HEADER_LIBRARY" show="false" value=""/>
    <elementParameter field="TEXT" name="HEADER_CODE" show="false" value=""/>
    <elementParameter field="TEXT" name="HEADER_IMPORT" show="false" value=""/>
    <elementParameter field="TEXT" name="HEADERFOOTER_FOOTERID" show="false" value=""/>
    <elementParameter field="CHECK" name="FOOTER_ENABLED" show="false" value="false"/>
    <elementParameter field="TEXT" name="FOOTER_LIBRARY" show="false" value=""/>
    <elementParameter field="TEXT" name="FOOTER_CODE" show="false" value=""/>
    <elementParameter field="TEXT" name="FOOTER_IMPORT" show="false" value=""/>
    <routinesParameter id="_uCmdUC3gEemv8rRsunnDIQ" name="DQTechnical"/>
    <routinesParameter id="_uCZB8i3gEemv8rRsunnDIQ" name="DataMasking"/>
    <routinesParameter id="_uCquwC3gEemv8rRsunnDIQ" name="DataOperation"/>
    <routinesParameter id="_uCfvoC3gEemv8rRsunnDIQ" name="DataQualityDependencies"/>
    <routinesParameter id="_uCcsUC3gEemv8rRsunnDIQ" name="DataQuality"/>
    <routinesParameter id="_uCjaAC3gEemv8rRsunnDIQ" name="DqStringHandling"/>
    <routinesParameter id="_uCtyEC3gEemv8rRsunnDIQ" name="Mathematical"/>
    <routinesParameter id="_uCyDgC3gEemv8rRsunnDIQ" name="Numeric"/>
    <routinesParameter id="_uC0fwC3gEemv8rRsunnDIQ" name="Relational"/>
    <routinesParameter id="_uDFlgC3gEemv8rRsunnDIQ" name="SQLike"/>
    <routinesParameter id="_uC3jEC3gEemv8rRsunnDIQ" name="StringHandling"/>
    <routinesParameter id="_uC7NcC3gEemv8rRsunnDIQ" name="TalendDataGenerator"/>
    <routinesParameter id="_uC9CoC3gEemv8rRsunnDIQ" name="TalendDate"/>
    <routinesParameter id="_uDCiMC3gEemv8rRsunnDIQ" name="TalendStringUtil"/>
    <routinesParameter id="_uDAF8C3gEemv8rRsunnDIQ" name="TalendString"/>
  </parameters>
  <node componentName="tVerticaRow" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="384" posY="128">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBRow_8"/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" show="false" value="VERTICA_9_0"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="true"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value="tDBConnection_1"/>
    <elementParameter field="TEXT" name="HOST" show="false" value="&quot;10.4.32.25&quot;"/>
    <elementParameter field="TEXT" name="PORT" show="false" value="&quot;5433&quot;"/>
    <elementParameter field="TEXT" name="DBNAME" show="false" value="&quot;ksa_db_prod&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" show="false" value="&quot;stg&quot;"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="VERTICA"/>
    <elementParameter field="TEXT" name="USER" show="false" value="&quot;talend&quot;"/>
    <elementParameter field="PASSWORD" name="PASS" show="false" value="enc:system.encryption.key.v1:NcWEi2vWKnmcYTnmjacICJXEukCTFQlH5acXcUMJQ5etEw6uD4k+SQ=="/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;INSERT INTO &quot;+context.connection_verticadb_schema_stg+&quot;.nobill_aggr_merge_init_tkey_2&#13;&#10; SELECT &#13;&#10;&#9;ad_source,&#13;&#10;&#9;a.ad_date,&#13;&#10;&#9;ad_dpo_id,&#13;&#10;&#9;CASE WHEN a.ad_subscription_date IS NULL THEN b.ad_subscription_date ELSE a.ad_subscription_date END AS ad_subscription_date,&#13;&#10;&#9;ad_subscription_type_id,&#13;&#10;&#9;ad_accountnum,&#13;&#10;&#9;ad_msisdn,&#13;&#10;&#9;ad_imsi,&#13;&#10;&#9;ad_call_direction_id,&#13;&#10;&#9;ad_calltype,&#13;&#10;&#9;ad_terminationreason,&#13;&#10;&#9;ad_mobilecountrycode,&#13;&#10;&#9;ad_mobilenetworkcode,&#13;&#10;&#9;ad_cell_site_id,&#13;&#10;&#9;ad_service_type_id,&#13;&#10;&#9;ad_country_operator_id,&#13;&#10;&#9;ad_eris_country_operator_id,&#13;&#10;&#9;ad_origzone_id,&#13;&#10;&#9;ad_termzone_id,&#13;&#10;&#9;ad_eventid,&#13;&#10;&#9;ad_package_id,&#13;&#10;&#9;ad_adjustment_type_id,&#13;&#10;&#9;ad_voucher_type_id,&#13;&#10;&#9;ad_counter_type_id,&#13;&#10;&#9;a.ad_counter_id,&#13;&#10;&#9;ad_updatetype,&#13;&#10;&#9;ad_total_quantity,&#13;&#10;&#9;ad_total_adjustment_amount,&#13;&#10;&#9;ad_total_valuediff,&#13;&#10;&#9;ad_total_duration_actual,&#13;&#10;&#9;ad_total_duration_sec,&#13;&#10;&#9;ad_total_duration_min,&#13;&#10;&#9;ad_total_duration_charged,&#13;&#10;&#9;ad_total_duration,&#13;&#10;&#9;ad_total_duration_payg,&#13;&#10;&#9;ad_total_duration_counter,&#13;&#10;&#9;ad_total_duration_counter_expired,&#13;&#10;&#9;ad_total_duration_counter_reset,&#13;&#10;&#9;ad_total_sms,&#13;&#10;&#9;ad_total_sms_payg,&#13;&#10;&#9;ad_total_sms_counter,&#13;&#10;&#9;ad_total_sms_counter_expired,&#13;&#10;&#9;ad_total_sms_counter_reset,&#13;&#10;&#9;ad_total_data_volume_received,&#13;&#10;&#9;ad_total_data_volume_sent,&#13;&#10;&#9;ad_total_data_volume_actual,&#13;&#10;&#9;ad_total_data_volume,&#13;&#10;&#9;ad_total_data_volume_payg,&#13;&#10;&#9;ad_total_data_volume_counter,&#13;&#10;&#9;ad_total_data_volume_expired,&#13;&#10;&#9;ad_total_data_volume_reset,&#9;&#13;&#10;&#9;ad_total_revenue_gross,&#13;&#10;&#9;ad_total_revenue_received,&#13;&#10;&#9;ad_total_balance_initial,&#13;&#10;&#9;ad_transaction_key,&#13;&#10;&#9;ad_total_counter_volume_revised,&#13;&#10;&#9;ad_total_counter_volume_revised_expired,&#13;&#10;&#9;ad_total_counter_volume_revised_reset,&#13;&#10;&#9;ad_total_volume_revised,&#13;&#10;&#9;--payg revenues&#13;&#10;&#9;ad_total_revenue_gross_payg,&#13;&#10;&#9;ad_total_revenue_received_payg,&#13;&#10;&#9;-- upfront bundle subscriptions&#13;&#10;&#9;ad_total_revenue_gross_upfront_bundle,&#13;&#10;&#9;ad_total_revenue_received_upfront_bundle,&#13;&#10;&#9;--time based&#13;&#10;&#9;ad_total_revenue_gross_time_bundle ,&#13;&#10;&#9;ad_total_revenue_received_time_bundle,&#13;&#10;&#9;ad_total_volume_wholesale,&#13;&#10;&#9;--usage bundle revenue&#13;&#10;&#9;ZEROIFNULL(ad_total_counter_volume_revised) * NVL(gross_rate,0) AS ad_total_revenue_gross_usage_bundle,&#13;&#10;&#9;ZEROIFNULL(ad_total_counter_volume_revised) * NVL(net_rate,0) AS ad_total_revenue_received_usage_bundle,&#13;&#10;&#9;ZEROIFNULL(ad_total_counter_volume_revised_expired) * NVL(gross_rate,0) AS ad_total_revenue_gross_expired_bundle,&#13;&#10;&#9;ZEROIFNULL(ad_total_counter_volume_revised_expired) * NVL(net_rate,0) AS ad_total_revenue_received_expired_bundle,&#13;&#10;&#9;ZEROIFNULL(ad_total_counter_volume_revised_reset) * NVL(gross_rate,0) AS ad_total_revenue_gross_reset_bundle,&#13;&#10;&#9;ZEROIFNULL(ad_total_counter_volume_revised_reset) * NVL(net_rate,0) AS ad_total_revenue_received_reset_bundle&#9;&#13;&#10; FROM &#13;&#10; (SELECT &#13;&#10;&#9;ad_source,&#13;&#10;&#9;ad_date,&#13;&#10;&#9;ad_dpo_id,&#13;&#10;&#9;ad_subscription_date,&#13;&#10;&#9;ad_subscription_type_id,&#13;&#10;&#9;ad_accountnum,&#13;&#10;&#9;ad_msisdn,&#13;&#10;&#9;ad_imsi,&#13;&#10;&#9;ad_call_direction_id,&#13;&#10;&#9;ad_calltype,&#13;&#10;&#9;ad_terminationreason,&#13;&#10;&#9;ad_mobilecountrycode,&#13;&#10;&#9;ad_mobilenetworkcode,&#13;&#10;&#9;ad_cell_site_id,&#13;&#10;&#9;ad_service_type_id,&#13;&#10;&#9;ad_country_operator_id,&#13;&#10;&#9;ad_eris_country_operator_id,&#13;&#10;&#9;ad_origzone_id,&#13;&#10;&#9;ad_termzone_id,&#13;&#10;&#9;ad_eventid,&#13;&#10;&#9;ad_package_id,&#13;&#10;&#9;ad_adjustment_type_id,&#13;&#10;&#9;ad_voucher_type_id,&#13;&#10;&#9;ad_counter_type_id,&#13;&#10;&#9;ad_counter_id,&#13;&#10;&#9;ad_updatetype,&#13;&#10;&#9;ad_total_quantity,&#13;&#10;&#9;ad_total_adjustment_amount,&#13;&#10;&#9;ad_total_valuediff,&#13;&#10;&#9;ad_total_duration_actual,&#13;&#10;&#9;ad_total_duration_sec,&#13;&#10;&#9;ad_total_duration_min,&#13;&#10;&#9;ad_total_duration_charged,&#13;&#10;&#9;ad_total_duration,&#13;&#10;&#9;ad_total_duration_payg,&#13;&#10;&#9;ad_total_duration_counter,&#13;&#10;&#9;ad_total_duration_counter_expired,&#13;&#10;&#9;ad_total_duration_counter_reset,&#13;&#10;&#9;ad_total_sms,&#13;&#10;&#9;ad_total_sms_payg,&#13;&#10;&#9;ad_total_sms_counter,&#13;&#10;&#9;ad_total_sms_counter_expired,&#13;&#10;&#9;ad_total_sms_counter_reset,&#13;&#10;&#9;ad_total_data_volume_received,&#13;&#10;&#9;ad_total_data_volume_sent,&#13;&#10;&#9;ad_total_data_volume_actual,&#13;&#10;&#9;ad_total_data_volume,&#13;&#10;&#9;ad_total_data_volume_payg,&#13;&#10;&#9;ad_total_data_volume_counter,&#13;&#10;&#9;ad_total_data_volume_expired,&#13;&#10;&#9;ad_total_data_volume_reset,&#13;&#10;&#9;ad_total_revenue_gross,&#13;&#10;&#9;ad_total_revenue_received,&#13;&#10;&#9;ad_total_balance_initial,&#13;&#10;&#9;ad_transaction_key,&#13;&#10;&#9;--usage bundle volumes&#13;&#10;&#9;ZEROIFNULL(ad_total_counter_volume_revised) ad_total_counter_volume_revised,&#13;&#10;&#9;ZEROIFNULL(ad_total_counter_volume_revised_expired) ad_total_counter_volume_revised_expired,&#13;&#10;&#9;ZEROIFNULL(ad_total_counter_volume_revised_reset) ad_total_counter_volume_revised_reset,&#13;&#10;&#9;ad_total_volume_revised,&#13;&#10;&#9;--payg revenues&#13;&#10;&#9;ad_total_revenue_gross_payg,&#13;&#10;&#9;ad_total_revenue_received_payg,&#13;&#10;&#9;-- upfront bundle subscriptions&#13;&#10;&#9;ad_total_revenue_gross_upfront_bundle,&#13;&#10;&#9;ad_total_revenue_received_upfront_bundle,&#13;&#10;&#9;ad_total_revenue_gross_time_bundle ,&#13;&#10;&#9;ad_total_revenue_received_time_bundle,&#13;&#10;&#9;ad_total_volume_wholesale&#13;&#10; FROM &#13;&#10;&#9;&quot;+context.connection_verticadb_schema_stg+&quot;.nobill_aggr_merge_init_tkey&#13;&#10;WHERE &#13;&#10;ad_date = '&quot;+context.vLoadDate+&quot;' &#13;&#10;ORDER BY &#13;&#10;ad_counter_id )a&#13;&#10;LEFT JOIN &#13;&#10;(SELECT &#13;&#10;&#9;bundle_creation_date AS ad_subscription_date,&#13;&#10;&#9;counter_id AS ad_counter_id, &#13;&#10;&#9;NVL(gross_rate,0) AS gross_rate,&#13;&#10;&#9;NVL(net_rate,0) AS net_rate&#13;&#10;FROM &#13;&#10;&#9;&quot;+context.connection_verticadb_schema_stg+&quot;.nobill_fact_subscription_rate&#13;&#10;WHERE &#13;&#10;&#9;bundle_creation_date BETWEEN ('&quot;+context.vLoadDate+&quot;'::date - INTERVAL '180 day')::date AND '&quot;+context.vLoadDate+&quot;'&#13;&#10;ORDER BY &#13;&#10;&#9;counter_id ) b &#13;&#10;ON a.ad_counter_id = b.ad_counter_id ;&quot;&#13;&#10;&#13;&#10;&#13;&#10;"/>
    <elementParameter field="CLOSED_LIST" name="USE_NB_LINE" value="NB_LINE_INSERTED"/>
    <elementParameter field="LABEL" name="USE_NB_LINE_NOTE" value="* Only used if the query is an insert, an update or a delete."/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="true"/>
    <elementParameter field="TEXT" name="PROPERTIES" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="PROPAGATE_RECORD_SET" value="false"/>
    <elementParameter field="COLUMN_LIST" name="RECORD_SET_COLUMN" show="false" value=""/>
    <elementParameter field="CHECK" name="USE_PREPAREDSTATEMENT" value="false"/>
    <elementParameter field="TABLE" name="SET_PREPAREDSTATEMENT_PARAMETERS" show="false"/>
    <elementParameter field="TEXT" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="Load aggr tkey 2"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tDBRow_8"/>
    <metadata connector="REJECT" name="REJECT">
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tVerticaRow" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="192" posY="0">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBRow_1"/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" show="false" value="VERTICA_9_0"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="true"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value="tDBConnection_1"/>
    <elementParameter field="TEXT" name="HOST" show="false" value="&quot;10.4.32.25&quot;"/>
    <elementParameter field="TEXT" name="PORT" show="false" value="&quot;5433&quot;"/>
    <elementParameter field="TEXT" name="DBNAME" show="false" value="&quot;ksa_db_prod&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" show="false" value="&quot;stg&quot;"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="VERTICA"/>
    <elementParameter field="TEXT" name="USER" show="false" value="&quot;talend&quot;"/>
    <elementParameter field="PASSWORD" name="PASS" show="false" value="enc:system.encryption.key.v1:B+D91kADTZqcbiV3xSfaXLb1zHzc+vJXf1kpQYkCN6wOX3fMotLdeQ=="/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;TRUNCATE TABLE &quot;+context.connection_verticadb_schema_stg+&quot;.nobill_aggr_merge_init_tkey_2;&#13;&#10; DELETE FROM  &quot;+context.connection_verticadb_schema_prod+&quot;.nobill_aggr_ws_cost&#13;&#10; WHERE ad_date = '&quot;+context.vLoadDate+&quot;'&quot;"/>
    <elementParameter field="CLOSED_LIST" name="USE_NB_LINE" value="NONE"/>
    <elementParameter field="LABEL" name="USE_NB_LINE_NOTE" value="* Only used if the query is an insert, an update or a delete."/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="true"/>
    <elementParameter field="TEXT" name="PROPERTIES" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="PROPAGATE_RECORD_SET" value="false"/>
    <elementParameter field="COLUMN_LIST" name="RECORD_SET_COLUMN" show="false" value=""/>
    <elementParameter field="CHECK" name="USE_PREPAREDSTATEMENT" value="false"/>
    <elementParameter field="TABLE" name="SET_PREPAREDSTATEMENT_PARAMETERS" show="false"/>
    <elementParameter field="TEXT" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="Clear table for the date"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tDBRow_1"/>
    <metadata connector="REJECT" name="REJECT">
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tJobLog" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="0" posY="0">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tJobLog_1"/>
    <elementParameter field="RADIO" name="DEV_LOG" value="true"/>
    <elementParameter field="RADIO" name="BUSINESS_LOG" value="false"/>
    <elementParameter field="TEXT" name="MESSAGE" value="&quot;VMKSA: Clearing temp table and nobill_aggr_ws_cost records for the date: &quot; + context.vLoadDate"/>
    <elementParameter field="CLOSED_LIST" name="PRIORITY" value="20000"/>
    <elementParameter field="TEXT" name="LABEL" value="logs info"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJobLog_1"/>
  </node>
  <node componentName="tJobLog" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="192" posY="128">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tJobLog_3"/>
    <elementParameter field="RADIO" name="DEV_LOG" value="true"/>
    <elementParameter field="RADIO" name="BUSINESS_LOG" value="false"/>
    <elementParameter field="TEXT" name="MESSAGE" value="&quot;VMKSA: Loading nobill_aggr_merge_init_tkey_2 temp table records for the date: &quot; + context.vLoadDate"/>
    <elementParameter field="CLOSED_LIST" name="PRIORITY" value="20000"/>
    <elementParameter field="TEXT" name="LABEL" value="logs info"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJobLog_3"/>
  </node>
  <node componentName="tJobLog" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="384" posY="256">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tJobLog_4"/>
    <elementParameter field="RADIO" name="DEV_LOG" value="true"/>
    <elementParameter field="RADIO" name="BUSINESS_LOG" value="false"/>
    <elementParameter field="TEXT" name="MESSAGE" value="&quot;VMKSA: Loaded nobill_aggr_merge_init_tkey_2 temp table. Number of records inserted: &quot;+ ((Integer)globalMap.get(&quot;tDBRow_8_NB_LINE_INSERTED&quot;))+&quot; .Running statistics.&quot;"/>
    <elementParameter field="CLOSED_LIST" name="PRIORITY" value="20000"/>
    <elementParameter field="TEXT" name="LABEL" value="logs info"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJobLog_4"/>
  </node>
  <node componentName="tJobLog" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="1440" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tJobLog_5"/>
    <elementParameter field="RADIO" name="DEV_LOG" value="true"/>
    <elementParameter field="RADIO" name="BUSINESS_LOG" value="false"/>
    <elementParameter field="TEXT" name="MESSAGE" value="&quot;Loaded #records: &quot;+((Integer)globalMap.get(&quot;tDBRow_4_NB_LINE_INSERTED&quot;))+&quot; into nobill_aggr_ws_cos records for the date: &quot; + context.vLoadDate"/>
    <elementParameter field="CLOSED_LIST" name="PRIORITY" value="20000"/>
    <elementParameter field="TEXT" name="LABEL" value="logs info"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJobLog_5"/>
  </node>
  <node componentName="tVerticaRow" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="640" posY="128">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBRow_3"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:PROPERTY_TYPE" show="false" value="REPOSITORY"/>
    <elementParameter field="TECHNICAL" name="PROPERTY:REPOSITORY_PROPERTY_TYPE" show="false" value="_5iHVAEWDEemVVo7G2ZId6g"/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" show="false" value="VERTICA_9_0"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="true"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value="tDBConnection_1"/>
    <elementParameter field="TEXT" name="HOST" show="false" value="&quot;10.4.32.25&quot;"/>
    <elementParameter field="TEXT" name="PORT" show="false" value="&quot;5433&quot;"/>
    <elementParameter field="TEXT" name="DBNAME" show="false" value="&quot;ksa_db_prod&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" show="false" value="&quot;prod&quot;"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="VERTICA"/>
    <elementParameter field="TEXT" name="USER" show="false" value="&quot;talend&quot;"/>
    <elementParameter field="PASSWORD" name="PASS" show="false" value="enc:system.encryption.key.v1:FBBErVcvDHeHiUrYAIAFKjeZMS3NWaylJZ0dBkOpKLyrS/F/4xv1rQ=="/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;SELECT analyze_statistics('&quot;+context.connection_verticadb_schema_stg+&quot;.nobill_aggr_merge_init_tkey_2'); &quot;"/>
    <elementParameter field="CLOSED_LIST" name="USE_NB_LINE" value="NONE"/>
    <elementParameter field="LABEL" name="USE_NB_LINE_NOTE" value="* Only used if the query is an insert, an update or a delete."/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="true"/>
    <elementParameter field="TEXT" name="PROPERTIES" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="PROPAGATE_RECORD_SET" value="false"/>
    <elementParameter field="COLUMN_LIST" name="RECORD_SET_COLUMN" show="false" value=""/>
    <elementParameter field="CHECK" name="USE_PREPAREDSTATEMENT" value="false"/>
    <elementParameter field="TABLE" name="SET_PREPAREDSTATEMENT_PARAMETERS" show="false"/>
    <elementParameter field="TEXT" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="run analyze_statistics"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tDBRow_3"/>
    <metadata connector="REJECT" name="REJECT">
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tJobLog" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="640" posY="256">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tJobLog_6"/>
    <elementParameter field="RADIO" name="DEV_LOG" value="true"/>
    <elementParameter field="RADIO" name="BUSINESS_LOG" value="false"/>
    <elementParameter field="TEXT" name="MESSAGE" value="&quot;VMKSA: Loading nobill_aggr_ws_cost records for the date: &quot; + context.vLoadDate"/>
    <elementParameter field="CLOSED_LIST" name="PRIORITY" value="20000"/>
    <elementParameter field="TEXT" name="LABEL" value="logs info"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJobLog_6"/>
  </node>
  <node componentName="tVerticaInput" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="928" posY="128">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_1"/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" show="false" value="VERTICA_9_0"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="true"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value="tDBConnection_1"/>
    <elementParameter field="TEXT" name="HOST" show="false" value="&quot;10.4.32.25&quot;"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="VERTICA"/>
    <elementParameter field="TEXT" name="PORT" show="false" value="&quot;5433&quot;"/>
    <elementParameter field="TEXT" name="DBNAME" show="false" value="&quot;ksa_db_prod&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" show="false" value="&quot;stg&quot;"/>
    <elementParameter field="TEXT" name="USER" show="false" value="&quot;talend&quot;"/>
    <elementParameter field="PASSWORD" name="PASS" show="false" value="enc:system.encryption.key.v1:zsKrFk5e72G+IU5j+QvlZ2tTtnkgben+sP9M4LnTJGE+7QTUGSNhWg=="/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="GUESS_SCHEMA" name="GUESS_SCHEMA" value="&quot;&quot;"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;SELECT&#13;&#10; &#9;ZEROIFNULL(monthly_upfront_rech_discount_percentage) AS monthly_upfront_rech_discount_percentage&#13;&#10; FROM &#13;&#10;&#9;&quot;+context.connection_verticadb_schema_stg+&quot;.erp_rech_disc_monthly&#13;&#10; WHERE &#13;&#10;&#9;'&quot;+context.vLoadDate+&quot;' BETWEEN start_date and end_date&quot;"/>
    <elementParameter field="MAPPING_TYPE" name="MAPPING" show="false" value="vertica_id"/>
    <elementParameter field="TEXT" name="PROPERTIES" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="TRIM_ALL_COLUMN" value="false"/>
    <elementParameter field="TABLE" name="TRIM_COLUMN">
      <elementValue elementRef="SCHEMA_COLUMN" value="monthly_upfront_rech_discount_percentage"/>
      <elementValue elementRef="TRIM" value="false"/>
    </elementParameter>
    <elementParameter field="TEXT" name="LABEL" value="get upfront rech disc percentage"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tDBInput_1">
      <column comment="" key="false" length="19" name="monthly_upfront_rech_discount_percentage" nullable="true" originalLength="19" pattern="" precision="10" sourceType="DOUBLE PRECISION" type="id_Double" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tJavaRow" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="1120" posY="128">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tJavaRow_1"/>
    <elementParameter field="MEMO_JAVA" name="CODE" value="context.vUpRechDiscPercent = row1.monthly_upfront_rech_discount_percentage;&#10;System.out.println(context.vUpRechDiscPercent);"/>
    <elementParameter field="MEMO_IMPORT" name="IMPORT" value="//import java.util.List;"/>
    <elementParameter field="TEXT" name="LABEL" value="set variable"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJavaRow_1"/>
  </node>
  <node componentName="tJobLog" componentVersion="0.101" offsetLabelX="0" offsetLabelY="0" posX="1440" posY="128">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tJobLog_7"/>
    <elementParameter field="RADIO" name="DEV_LOG" value="true"/>
    <elementParameter field="RADIO" name="BUSINESS_LOG" value="false"/>
    <elementParameter field="TEXT" name="MESSAGE" value="&quot;Uprfont Recharge Discount is : &quot;+context.vUpRechDiscPercent+&quot;  . Loading nobill_aggr_ws_cost for the date: &quot; + context.vLoadDate"/>
    <elementParameter field="CLOSED_LIST" name="PRIORITY" value="20000"/>
    <elementParameter field="TEXT" name="LABEL" value="logs info"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tJobLog_7"/>
  </node>
  <node componentName="tVerticaConnection" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="0" posY="-224">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBConnection_1"/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" value="VERTICA_9_0"/>
    <elementParameter field="TEXT" name="HOST" value="context.connection_verticadb_host"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="VERTICA"/>
    <elementParameter field="TEXT" name="PORT" value="context.connection_verticadb_port"/>
    <elementParameter field="TEXT" name="DBNAME" value="context.connection_verticadb_database"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" value="context.connection_verticadb_schema_prod"/>
    <elementParameter field="TEXT" name="USER" value="context.connection_verticadb_username"/>
    <elementParameter field="PASSWORD" name="PASS" value="enc:system.encryption.key.v1:8f4ZsGBZwD8X5Ws4/PBdMDXIIee//4V0ea5lWy3O8Zsqutw7h9fiKfuT3Iz1Q8jUmoTI3eWDAwtDFZ93qrZfpes="/>
    <elementParameter field="TEXT" name="PROPERTIES" value="context.connection_verticadb_additionalparam"/>
    <elementParameter field="ENCODING_TYPE" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TECHNICAL" name="ENCODING:ENCODING_TYPE" value="ISO-8859-15"/>
    <elementParameter field="CHECK" name="USE_SHARED_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="SHARED_CONNECTION_NAME" show="false" value=""/>
    <elementParameter field="CHECK" name="AUTO_COMMIT" value="false"/>
    <elementParameter field="TEXT" name="LABEL" value="connection_prod"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
  </node>
  <node componentName="tVerticaRow" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="1120" posY="320">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBRow_4"/>
    <elementParameter field="CLOSED_LIST" name="DB_VERSION" show="false" value="VERTICA_9_0"/>
    <elementParameter field="CHECK" name="USE_EXISTING_CONNECTION" value="true"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value="tDBConnection_1"/>
    <elementParameter field="TEXT" name="HOST" show="false" value="&quot;10.4.32.25&quot;"/>
    <elementParameter field="TEXT" name="PORT" show="false" value="&quot;5433&quot;"/>
    <elementParameter field="TEXT" name="DBNAME" show="false" value="&quot;ksa_db_prod&quot;"/>
    <elementParameter field="TEXT" name="SCHEMA_DB" show="false" value="&quot;stg&quot;"/>
    <elementParameter field="TEXT" name="TYPE" show="false" value="VERTICA"/>
    <elementParameter field="TEXT" name="USER" show="false" value="&quot;talend&quot;"/>
    <elementParameter field="PASSWORD" name="PASS" show="false" value="enc:system.encryption.key.v1:SJAd9jVh287CM7Iz6eq7pefTHfTjEOyWZxcQZ6GcfCNoMtzcBAJkNw=="/>
    <elementParameter field="DBTABLE" name="TABLE" value="&quot;&quot;"/>
    <elementParameter field="QUERYSTORE_TYPE" name="QUERYSTORE" value="&quot;&quot;"/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:REPOSITORY_QUERYSTORE_TYPE" show="false" value=""/>
    <elementParameter field="TECHNICAL" name="QUERYSTORE:QUERYSTORE_TYPE" value="BUILT_IN"/>
    <elementParameter field="MEMO_SQL" name="QUERY" value="&quot;INSERT INTO &quot;+context.connection_verticadb_schema_prod+&quot;.nobill_aggr_ws_cost&#13;&#10;SELECT&#13;&#10; /* Dimensions */&#13;&#10;                ad_source,&#13;&#10;                transaction_id AS ad_transaction_id,&#13;&#10;                ad_date,&#13;&#10;&#9;&#9;&#9;&#9;ad_dpo_id,&#13;&#10;                ad_subscription_date,  /* Applicable for time AND usage based */&#13;&#10;                ad_subscription_type_id,&#13;&#10;                ad_accountnum,&#13;&#10;                ad_msisdn,&#13;&#10;                ad_imsi,&#13;&#10;                ad_call_direction_id,&#13;&#10;                ad_calltype,&#13;&#10;                ad_terminationreason,&#13;&#10;                ad_mobilecountrycode,&#13;&#10;                ad_mobilenetworkcode,&#13;&#10;                ad_cell_site_id,&#13;&#10;                ad_service_type_id,&#13;&#10;                ad_country_operator_id,&#13;&#10;&#9;&#9;&#9;&#9;ad_eris_country_operator_id,&#13;&#10;                ad_origzone_id,&#13;&#10;                ad_termzone_id,&#13;&#10;                ad_eventid,&#13;&#10;&#9;&#9;&#9;&#9;ad_package_id,&#13;&#10;                ad_adjustment_type_id,&#13;&#10;                ad_voucher_type_id,&#13;&#10;                ad_counter_type_id,&#13;&#10;                ad_counter_id,&#13;&#10;                ad_updatetype,&#13;&#10;/* Metrics */&#13;&#10;                ad_total_quantity,&#13;&#10;                ad_total_adjustment_amount,&#13;&#10;                ad_total_valuediff,&#13;&#10;                ad_total_duration_actual,&#13;&#10;                ad_total_duration_sec,&#13;&#10;                ad_total_duration_min,&#13;&#10;                ad_total_duration_charged,&#13;&#10;                ad_total_duration,&#13;&#10;                ad_total_duration_payg,&#13;&#10;                ad_total_duration_counter,&#13;&#10;                ad_total_duration_counter_expired,&#13;&#10;                ad_total_duration_counter_reset,&#13;&#10;                ad_total_sms,&#13;&#10;                ad_total_sms_payg,&#13;&#10;                ad_total_sms_counter,&#13;&#10;                ad_total_sms_counter_expired,&#13;&#10;                ad_total_sms_counter_reset,&#13;&#10;                ad_total_data_volume_received,&#13;&#10;                ad_total_data_volume_sent,&#13;&#10;                ad_total_data_volume_actual,&#13;&#10;                ad_total_data_volume,&#13;&#10;                ad_total_data_volume_payg,&#13;&#10;                ad_total_data_volume_counter,&#13;&#10;                ad_total_data_volume_expired,&#13;&#10;                ad_total_data_volume_reset,&#13;&#10;&#9;&#9;&#9;&#9;ad_total_volume_wholesale,&#13;&#10;/* upfront Bundle revenue */&#13;&#10;                ad_total_revenue_gross_upfront_bundle,&#13;&#10;                ad_total_revenue_received_upfront_bundle,&#13;&#10;                ad_total_revenue_received_upfront_bundle - (ad_total_revenue_received_upfront_bundle*&quot;+context.vUpRechDiscPercent+&quot;) AS ad_total_revenue_net_upfront_bundle,&#13;&#10;/* PAYG Revenues after adjustments */&#13;&#10;                ad_total_revenue_gross_payg*NVL(revenue_share,1) AS ad_total_revenue_gross_payg,&#13;&#10;                ad_total_revenue_received_payg*NVL(revenue_share,1) AS ad_total_revenue_received_payg,&#13;&#10;                ad_total_revenue_received_payg*NVL(revenue_share,1) - (ad_total_revenue_received_payg*NVL(revenue_share,1)*&quot;+context.vUpRechDiscPercent+&quot;) AS ad_total_revenue_net_payg,&#13;&#10; /* Usage Bundle revenue */&#13;&#10;                ad_total_revenue_gross_usage_bundle,&#13;&#10;                ad_total_revenue_received_usage_bundle,&#13;&#10;                ad_total_revenue_received_usage_bundle - (ad_total_revenue_received_usage_bundle*&quot;+context.vUpRechDiscPercent+&quot;) AS ad_total_net_revenue_usage_bundle,&#13;&#10;/* Time Bundle revenue */&#13;&#10;                ad_total_revenue_gross_time_bundle AS ad_total_revenue_gross_time_bundle,&#13;&#10;                ad_total_revenue_received_time_bundle AS ad_total_revenue_received_time_bundle,&#13;&#10;                ad_total_revenue_received_time_bundle - (ad_total_revenue_received_time_bundle*&quot;+context.vUpRechDiscPercent+&quot;) AS ad_total_revenue_net_time_bundle,&#13;&#10;/* Expired Bundle Revenue */&#13;&#10;                ad_total_revenue_gross_expired_bundle,&#13;&#10;                ad_total_revenue_received_expired_bundle,&#13;&#10;                ad_total_revenue_received_expired_bundle - (ad_total_revenue_received_expired_bundle*&quot;+context.vUpRechDiscPercent+&quot;) AS ad_total_revenue_net_expired_bundle,&#13;&#10;/* Gross Revenue for Reporting - PAYG + Interconnect Revenue + Expired Bundles + Expired Credit */&#13;&#10;                (ad_total_revenue_gross_payg*NVL(revenue_share,1)) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_gross_usage_bundle) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_gross_expired_bundle) +&#13;&#10;                ZEROIFNULL((ad_total_volume_revised)*NVL(interconnect_revenue,0)) +&#13;&#10;                ZEROIFNULL(CASE WHEN ad_transaction_key = 'Expired_Credit' THEN -ZEROIFNULL(ad_total_adjustment_amount) ELSE 0 END) AS ad_total_revenue_gross,&#13;&#10;/* Received Revenue for Reporting PAYG + Interconnect Revenue + Expired Bundles + Expired Credit */&#13;&#10;                ad_total_revenue_received_payg*NVL(revenue_share,1) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_usage_bundle) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_expired_bundle) +&#13;&#10;                ZEROIFNULL((ad_total_volume_revised)*NVL(interconnect_revenue,0)) +&#13;&#10;                ZEROIFNULL(CASE WHEN ad_transaction_key = 'Expired_Credit' THEN -ZEROIFNULL(ad_total_adjustment_amount) ELSE 0 END) AS ad_total_revenue_received,&#13;&#10;/* Net Revenue for Reporting PAYG + Interconnect Revenue + Expired Bundles + Expired Credit - Upfront Recharge Discount */&#13;&#10;                (ad_total_revenue_received_payg*NVL(revenue_share,1) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_usage_bundle) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_expired_bundle) +&#13;&#10;                ZEROIFNULL((ad_total_volume_revised)*NVL(interconnect_revenue,0)) +&#13;&#10;                ZEROIFNULL(CASE WHEN ad_transaction_key = 'Expired_Credit' THEN -ZEROIFNULL(ad_total_adjustment_amount) ELSE 0 END)) -&#13;&#10;                ((ad_total_revenue_received_payg*NVL(revenue_share,1) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_usage_bundle) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_expired_bundle) +&#13;&#10;                ZEROIFNULL(CASE WHEN ad_transaction_key = 'Expired_Credit' THEN -ZEROIFNULL(ad_total_adjustment_amount) ELSE 0 END)) * &quot;+context.vUpRechDiscPercent+&quot;) AS ad_total_revenue_net,     &#13;&#10;/* Initial balance */&#13;&#10;&#9;&#9;&#9;&#9;ad_total_balance_initial,&#13;&#10;/* upfront recharge discount */&#13;&#10;&#9;&#9;&#9;&#9;(ad_total_revenue_received_payg*NVL(revenue_share,1) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_usage_bundle) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_expired_bundle) +&#13;&#10;                ZEROIFNULL(CASE WHEN ad_transaction_key = 'Expired_Credit' THEN -ZEROIFNULL(ad_total_adjustment_amount) ELSE 0 END)) * &quot;+context.vUpRechDiscPercent+&quot; AS ad_total_discount_upfront_recharge,&#13;&#10;/* gross revenue for wholesale */&#13;&#10;&#9;&#9;&#9;&#9;(ad_total_revenue_gross_payg*NVL(revenue_share,1)) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_gross_time_bundle) +&#13;&#10;                ZEROIFNULL((ad_total_volume_wholesale)*NVL(interconnect_revenue,0)) +&#13;&#10;                ZEROIFNULL(CASE WHEN ad_transaction_key = 'Expired_Credit' THEN -ZEROIFNULL(ad_total_adjustment_amount) ELSE 0 END) AS ad_total_revenue_gross_tb,&#13;&#10;/* Received revenue for wholesale */&#9;&#13;&#10;&#9;&#9;        (ad_total_revenue_received_payg*NVL(revenue_share,1) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_time_bundle) +&#13;&#10;                ZEROIFNULL((ad_total_volume_wholesale)*NVL(interconnect_revenue,0)) +&#13;&#10;                ZEROIFNULL(CASE WHEN ad_transaction_key = 'Expired_Credit' THEN -ZEROIFNULL(ad_total_adjustment_amount) ELSE 0 END)) AS ad_total_revenue_received_tb,&#13;&#10;/* net revenue for wholesale = Received - (Received-MTC)*UpfrontRechDiscPerc */&#13;&#10;&#9;&#9;&#9;&#9;((ad_total_revenue_received_payg*NVL(revenue_share,1) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_time_bundle) +&#13;&#10;                ZEROIFNULL((ad_total_volume_wholesale)*NVL(interconnect_revenue,0)) +&#13;&#10;                ZEROIFNULL(CASE WHEN ad_transaction_key = 'Expired_Credit' THEN -ZEROIFNULL(ad_total_adjustment_amount) ELSE 0 END)) -&#13;&#10;                ((ad_total_revenue_received_payg*NVL(revenue_share,1) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_time_bundle) +&#13;&#10;                ZEROIFNULL(CASE WHEN ad_transaction_key = 'Expired_Credit' THEN -ZEROIFNULL(ad_total_adjustment_amount) ELSE 0 END)) * &quot;+context.vUpRechDiscPercent+&quot; )) AS ad_total_revenue_net_tb,&#13;&#10;/* upfront recharge discount for wholesale */&#9;&#13;&#10;&#9;&#9;&#9;&#9;((ad_total_revenue_received_payg*NVL(revenue_share,1) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_time_bundle) +&#13;&#10;                ZEROIFNULL(CASE WHEN ad_transaction_key = 'Expired_Credit' THEN -ZEROIFNULL(ad_total_adjustment_amount) ELSE 0 END)) * &quot;+context.vUpRechDiscPercent+&quot; ) AS ad_total_discount_upfront_recharge_tb,&#13;&#10;/* Interconnect revenue */&#13;&#10;                (ad_total_volume_wholesale)*NVL(interconnect_revenue,0) AS ad_total_revenue_interconnect,&#13;&#10;/*  Interconnect Cost */&#13;&#10;&#9;&#9;&#9;&#9;(ad_total_volume_wholesale)* NVL(ws_cost,0) AS ad_total_cost_interconnect_actual,&#13;&#10;/* Columns maintained for future consideration  - currently populated AS zero*/&#13;&#10;&#9;&#9;&#9;&#9;0 AS ad_total_cost_interconnect,&#13;&#10;&#9;&#9;&#9;&#9;0 AS ad_total_cost_interconnect_payg,&#13;&#10;&#9;&#9;&#9;&#9;0 AS ad_total_cost_interconnect_counter,&#13;&#10;/* Access cost time based  = (Received Revenue - Upfront Recharge Discount  - Interconnect Cost) * Margin Share  */&#13;&#10;               ((ad_total_revenue_received_payg*NVL(revenue_share,1) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_time_bundle) +&#13;&#10;                ZEROIFNULL((ad_total_volume_wholesale)*NVL(interconnect_revenue,0)) +&#13;&#10;                ZEROIFNULL(CASE WHEN ad_transaction_key = 'Expired_Credit' THEN -ZEROIFNULL(ad_total_adjustment_amount) ELSE 0 END)) -&#13;&#10;                ((ad_total_revenue_received_payg*NVL(revenue_share,1) +&#13;&#10;                ZEROIFNULL(ad_total_revenue_received_time_bundle) +&#13;&#10;                ZEROIFNULL(CASE WHEN ad_transaction_key = 'Expired_Credit' THEN -ZEROIFNULL(ad_total_adjustment_amount) ELSE 0 END)) * &quot;+context.vUpRechDiscPercent+&quot;) -&#13;&#10;&#9;&#9;&#9;&#9;((ad_total_volume_wholesale)* NVL(ws_cost,0)))*NVL(margin_share,0) AS ad_total_cost_access_actual,&#9;&#9;&#9;&#9;&#13;&#10;&#9;&#9;&#9;&#9;0 AS ad_total_cost_access,&#13;&#10;&#9;&#9;&#9;&#9;0 AS ad_total_cost_access_payg,&#13;&#10;&#9;&#9;&#9;&#9;0 AS ad_total_cost_access_counter,&#13;&#10;&#9;&#9;&#9;&#9;0 AS ad_total_wholesale_duration&#13;&#10;FROM&#13;&#10;                &quot;+context.connection_verticadb_schema_stg+&quot;.nobill_aggr_merge_init_tkey_2 tkey&#13;&#10;LEFT JOIN&#13;&#10;                &quot;+context.connection_verticadb_schema_prod+&quot;.nobill_dim_transaction_key dtkey&#13;&#10; ON&#13;&#10;                tkey.ad_transaction_key = dtkey.transaction_key&#13;&#10;LEFT JOIN&#13;&#10;                &quot;+context.connection_verticadb_schema_stg+&quot;.nobill_dim_wholesale_cost ws&#13;&#10; ON&#13;&#10;                tkey.ad_transaction_key = ws.ws_transaction_key&#13;&#10;JOIN&#13;&#10;    &#9;&#9;&#9;&quot;+context.connection_verticadb_schema_stg+&quot;.nobill_dim_wholesale_version vr&#13;&#10; ON&#13;&#10;                (vr.ws_version_no) = (ws.ws_version_no)&#13;&#10;WHERE&#13;&#10;                ad_date = '&quot;+context.vLoadDate+&quot;'&#13;&#10;AND&#13;&#10;                tkey.ad_date &gt;= vr.start_date AND tkey.ad_date &lt;= vr.end_date;&#13;&#10;&quot;"/>
    <elementParameter field="CLOSED_LIST" name="USE_NB_LINE" value="NB_LINE_INSERTED"/>
    <elementParameter field="LABEL" name="USE_NB_LINE_NOTE" value="* Only used if the query is an insert, an update or a delete."/>
    <elementParameter field="CHECK" name="DIE_ON_ERROR" value="true"/>
    <elementParameter field="TEXT" name="PROPERTIES" show="false" value="&quot;&quot;"/>
    <elementParameter field="CHECK" name="PROPAGATE_RECORD_SET" value="false"/>
    <elementParameter field="COLUMN_LIST" name="RECORD_SET_COLUMN" show="false" value=""/>
    <elementParameter field="CHECK" name="USE_PREPAREDSTATEMENT" value="false"/>
    <elementParameter field="TABLE" name="SET_PREPAREDSTATEMENT_PARAMETERS" show="false"/>
    <elementParameter field="TEXT" name="ENCODING" show="false" value="&quot;ISO-8859-15&quot;"/>
    <elementParameter field="TEXT" name="COMMIT_EVERY" value="10000"/>
    <elementParameter field="TEXT" name="LABEL" value="load usage aggr ws cost V3"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tDBRow_4"/>
    <metadata connector="REJECT" name="REJECT">
      <column defaultValue="" key="false" length="255" name="errorCode" nullable="true" originalLength="-1" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
      <column defaultValue="" key="false" length="255" name="errorMessage" nullable="true" originalLength="-1" precision="0" sourceType="" type="id_String" usefulColumn="true"/>
    </metadata>
  </node>
  <node componentName="tVerticaCommit" componentVersion="0.102" offsetLabelX="0" offsetLabelY="0" posX="1120" posY="480">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBCommit_1"/>
    <elementParameter field="COMPONENT_LIST" name="CONNECTION" value="tDBConnection_1"/>
    <elementParameter field="CHECK" name="CLOSE" value="true"/>
    <elementParameter field="TEXT" name="LABEL" value="commit"/>
    <elementParameter field="TEXT" name="CONNECTION_FORMAT" value="row"/>
    <metadata connector="FLOW" name="tDBCommit_1"/>
  </node>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tDBRow_8" offsetLabelX="0" offsetLabelY="0" outputId="1" source="tDBRow_8" target="tJobLog_4">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnComponentOk7"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tDBRow_8" offsetLabelX="0" offsetLabelY="0" outputId="2" source="tDBRow_8" target="tDBRow_3">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnComponentOk11"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tDBRow_1" offsetLabelX="0" offsetLabelY="0" source="tDBRow_1" target="tJobLog_3">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnComponentOk2"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tJobLog_1" offsetLabelX="0" offsetLabelY="0" source="tJobLog_1" target="tDBRow_1">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnComponentOk4"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tJobLog_3" offsetLabelX="0" offsetLabelY="0" source="tJobLog_3" target="tDBRow_8">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnComponentOk6"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tDBRow_3" offsetLabelX="0" offsetLabelY="0" outputId="1" source="tDBRow_3" target="tJobLog_6">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnComponentOk8"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tDBRow_3" offsetLabelX="0" offsetLabelY="0" outputId="2" source="tDBRow_3" target="tDBInput_1">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnComponentOk12"/>
  </connection>
  <connection connectorName="FLOW" label="row1" lineStyle="0" metaname="tDBInput_1" offsetLabelX="0" offsetLabelY="0" source="tDBInput_1" target="tJavaRow_1">
    <elementParameter field="CHECK" name="MONITOR_CONNECTION" value="false"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="row1"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tJavaRow_1" offsetLabelX="0" offsetLabelY="0" outputId="1" source="tJavaRow_1" target="tJobLog_7">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnComponentOk14"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tJavaRow_1" offsetLabelX="0" offsetLabelY="0" outputId="2" source="tJavaRow_1" target="tDBRow_4">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnComponentOk9"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tDBConnection_1" offsetLabelX="0" offsetLabelY="0" source="tDBConnection_1" target="tJobLog_1">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnComponentOk15"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tDBRow_4" offsetLabelX="0" offsetLabelY="0" outputId="1" source="tDBRow_4" target="tDBCommit_1">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnComponentOk16"/>
  </connection>
  <connection connectorName="COMPONENT_OK" label="OnComponentOk" lineStyle="3" metaname="tDBRow_4" offsetLabelX="0" offsetLabelY="0" outputId="2" source="tDBRow_4" target="tJobLog_5">
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="OnComponentOk17"/>
  </connection>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBRow_8"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="Load tkey2"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="128;255;128"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBRow_1"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="Clear table for the date"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="128;255;128"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tJobLog_1"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="logs info"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="128;255;128"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tJobLog_3"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="logs info"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="128;255;128"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tJobLog_4"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="logs info"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="128;255;128"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tJobLog_5"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="logs info"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="128;255;128"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBRow_3"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="Run analyze_statistics"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="128;255;128"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tJobLog_6"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="logs info"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="128;255;128"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBInput_1"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="Get upfront rechare discount"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="128;255;128"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tJobLog_7"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="logs info"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="128;255;128"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBConnection_1"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="Connection PROD"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="128;255;128"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBRow_4"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="Load WS Cost Aggr"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="128;255;128"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
  <subjob>
    <elementParameter field="CHECK" name="SHOW_SUBJOB_TITLE" value="true"/>
    <elementParameter field="TEXT" name="UNIQUE_NAME" show="false" value="tDBCommit_1"/>
    <elementParameter field="TEXT" name="SUBJOB_TITLE" value="Commit"/>
    <elementParameter field="COLOR" name="SUBJOB_TITLE_COLOR" value="128;255;128"/>
    <elementParameter field="COLOR" name="SUBJOB_COLOR" value="207;226;236"/>
  </subjob>
<Signature xmlns="http://www.w3.org/2000/09/xmldsig#" Id="_8c19e6fe-34c1-4a94-ac67-c363bd41d04b"><SignedInfo><CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/><SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha512"/><Reference URI=""><Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/></Transforms><DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha512"/><DigestValue>z8lDfMVVNonNyG9GOREuQfFOkhlQghZrTaepPB+hzog+IEia9qgBJlVb+C/MZi9s/6av/7Dgw0lv&#13;
ZsLS2PKMSQ==</DigestValue></Reference><Reference Type="http://www.w3.org/2000/09/xmldsig#SignatureProperties" URI="#_280e394b-453c-4cbc-bde6-9b8d792111f3"><Transforms><Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/></Transforms><DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha512"/><DigestValue>Kj8pqdxUqnk6FdCFZnhU1SVqtHg5VVVaXat5n5kW3sj96BkvR3nFVngKpmauEnlMEjFc0KjwRbYh&#13;
vlGQHREqYQ==</DigestValue></Reference></SignedInfo><SignatureValue>Doy6eBfuSQkHTSbPp09y5IsquCbLY8iB2gfKSF+rzRoUA8DCH0PNth4bnKtQfzllt3NbM++oRHcS&#13;
a2vl+80VbaLQATPrH66RVr0/nL74caQKuISh6HMKzanFLhKr7SC1/RV2b/cbtPSginIobwDbMSvU&#13;
ACnlD+xYmzXcrMXWDob9glKHYB8BRAZfr8FKkxzJqQ9djpMyjAmUhUHHqhQKHerZIwVlBAJrIuGk&#13;
JIlYtjOLB9IInEpxC+Gcg4tWIRI8MLHzh2pSNeFxM8Xq2qmpC1h2iqTs5TmaD3fBw5lPX6fpstIW&#13;
Bdxh7VQIFPYnNxHyARNUQHhqOxBT3y6OZBgz9w==</SignatureValue><KeyInfo><X509Data><X509SubjectName>C=FR,ST=Paris,L=Paris,O=Talend Inc.,OU=R&amp;D,CN=Talend Code Signing certificate</X509SubjectName><X509Certificate>MIIFADCCAuigAwIBAgIIA2OsD6bRyj0wDQYJKoZIhvcNAQELBQAwgY0xCzAJBgNVBAYTAkZSMQ4w&#13;
DAYDVQQIEwVQYXJpczEOMAwGA1UEBxMFUGFyaXMxFDASBgNVBAoTC1RhbGVuZCBJbmMuMQwwCgYD&#13;
VQQLDANSJkQxFjAUBgNVBAMMDVRhbGVuZCBSJkQgQ0ExIjAgBgkqhkiG9w0BCQEWE3NlY3VyaXR5&#13;
QHRhbGVuZC5jb20wHhcNMTkwNjAzMDgxODIwWhcNMjkwNjAzMDAwMDAwWjB7MSgwJgYDVQQDEx9U&#13;
YWxlbmQgQ29kZSBTaWduaW5nIGNlcnRpZmljYXRlMQwwCgYDVQQLDANSJkQxFDASBgNVBAoTC1Rh&#13;
bGVuZCBJbmMuMQ4wDAYDVQQHEwVQYXJpczEOMAwGA1UECBMFUGFyaXMxCzAJBgNVBAYTAkZSMIIB&#13;
IjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAp5TMF8BmRt8dY51t9kIDdDkoOKVVytJN2gn2&#13;
DhMGi8hzpUofNDykJDhe9SPqyJdGZ6o/h7laTA0/CivKyPT1OJQ9E2gMHKs8cTZM/cO2w0Atlqkl&#13;
alIxepol0DNnUtmECVBqdnVsJesfmdoeptxgJAtxYbquFsTsrATNY2cscXpwmOca/Ewip48WQLFx&#13;
e5s067jaIsAQGRIqpIup3bOtWBySrtImJ40lQCPeEcl96qzkv3utaVaNc3ukkhYkCDbMbK8NVd1B&#13;
CVeeIBAe+n/SdpHH20o+6eIiZecsBGDLwlTYrFvuVqAa6xI7y8Vdz6irjPAVBEtG/iOc782aJ/lZ&#13;
TwIDAQABo3UwczAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIHgDATBgNVHSUEDDAKBggrBgEF&#13;
BQcDAzAdBgNVHQ4EFgQUGdfzQEbjQnANq28sfhEMTx+rsOcwHwYDVR0jBBgwFoAU530Lcvy1gZnG&#13;
gCvZLOyCczK1qPcwDQYJKoZIhvcNAQELBQADggIBAEr22wnaQwZm2dhbUCqD+qZpTq2AF/tzxqAM&#13;
eL/CiTjPbTblS4SNNwCKvTgMe9ucpUbenXmK7xE+DU9dN4om+t3VHbkOLQVyuLcd2WGsy7ZGwRvA&#13;
f+TFwLbwjyTukOGm6Sd1qyZgvCPzBsKnft6vscvGy2yEpmFCeHJyBP8pvchg607zguRdNbkGYZXw&#13;
G6jNipAbTtzdPTFKKr1bEf0sUGqMrlZIMPjflh2Vewu8ImNdX5IZdvBD6DdFVOC5wqV6u+W9ukE/&#13;
mXZxDBYNl2AF7FTh04ucEVN3mHv7m2L0uFvUlhxchcagJhJsdQG+A0LVCemHbp6CSNQJx02KxqUG&#13;
hakvpzhOyLo91h8YAQrEZJdNuKA8IYmBrFZQZDCz0uywKSyFfzPyJhvxylCLG/iDPPfE0VWcrMJ/&#13;
WQJly/2XPg/NBCTF3pSKS0kCiA7PeaI3cWkMYYA3PMwYDvzqs1opBRglG7ikj0bQxSm3lcjMuuvW&#13;
gBRksFKjP3K/nztsjSoYITOM9jR29ReIL3v0E8RbAFwA2RGq6Dxd0ixfbucMesy5Gnr8tfYy6rW+&#13;
qSQqd3ah4+PSzBNVwIB4ytpdrG3SlhCI2i2Th8ek8Sjsaquh9qPAerWNd2+84HWOOGj1Xe1qc6vg&#13;
qqu6JoK9EXKDiwBqDVkueIa+MhamE1VDnhn2pPui</X509Certificate></X509Data></KeyInfo><Object><SignatureProperties><SignatureProperty Id="_280e394b-453c-4cbc-bde6-9b8d792111f3" Target="#_8c19e6fe-34c1-4a94-ac67-c363bd41d04b"><Timestamp>2023-05-17 07:47:46</Timestamp></SignatureProperty></SignatureProperties></Object></Signature></talendfile:ProcessType>